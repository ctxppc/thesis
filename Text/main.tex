% © 2021–2022 Constantino Tsarouhas
\documentclass[master=cws, oneside, english, extralanguage=dutch]{kulemt}	% TODO: twoside for print
\setup{
	masteroption=vs,
	title={Glyco: A CHERI-RISC-V nanopass compiler for experimenting with capability-based security features},
	author={Constantino Tsarouhas},
	promotor={Prof. dr. Dominique Devriese},
	assistant={Ir. Sander Huyghebaert\and{}Dr. Steven Keuchel},
	assessor=,	% TODO
	inputenc=utf8,
	font=utopia
}

\usepackage{amsmath}							% Math support
\usepackage{babel}								% Language support
\usepackage{booktabs}							% Prettier table rules
\usepackage[margin=10pt, font=small]{caption}	% Customised captions to distinguish them from main text
\usepackage{changepage}							% Adjust margins — used for figures/tables wider than text width
\usepackage[autostyle]{csquotes}				% Curly quotes
\usepackage{enumitem}							% Compact list items

\usepackage[dvipsnames]{xcolor}					% Named colours — keep before hyperref
\usepackage{hyperref}							% Hyperlinking and PDF metadata.
\usepackage[capitalise, nameinlink]{cleveref}	% Better references — keep after hyperref
\usepackage[toc]{glossaries}					% Glossary — keep after hyperref!

\usepackage{lipsum}								% Fake lorem ipsum text — TODO: Remove when done
\usepackage{minted}								% Source code
\usepackage{natbib}								% Better citations
\usepackage{sidecap}							% Side-captions (for narrow figures)
\usepackage{subfiles}							% Modular documents
\usepackage{syntax}								% Grammar
\usepackage{todonotes}							% Marks TODOs — TODO: Remove when done
\usepackage{xparse}								% Advanced command parsing — used in newdualentry

\newcommand{\shb}[1]{\todo[color=orange!40,author=Sander,inline]{#1}}

\DeclareUnicodeCharacter{039B}{$\Lambda$}
\DeclareUnicodeCharacter{03BB}{$\lambda$}
\DeclareUnicodeCharacter{2026}{$\dots$}

\bibliographystyle{plainnat}

\hypersetup{
    colorlinks=true,		% false: boxed links; true: coloured links
    linkcolor=Blue,			% colour of internal links
    citecolor=OliveGreen,	% colour of reference links
    filecolor=cyan,			% colour of file links
    urlcolor=magenta		% colour of external links
}

\renewcommand{\syntleft}{\normalfont\color{Plum}\itshape}
\renewcommand{\syntright}{}
\renewcommand{\ulitleft}{\normalfont\bfseries\frenchspacing}
\renewcommand{\ulitright}{}

\setminted{
    autogobble=true,	% remove leading whitespace
    fontsize=\footnotesize,
    linenos=true,
    style=trac,
    stripall=true,		% remove leading/trailing whitespace
    stripnl=true,		% remove leading/trailing newlines
	tabsize=2
}
\newmintinline[iil]{prolog}{fontsize=}
\newmintinline[irv]{ca65}{fontsize=}
\newminted[il]{prolog}{}
\newmintedfile[ilfile]{prolog}{}
\newminted[swift]{swift}{style=xcode}

\newcommand{\onlyinsubfile}[1]{#1}
\newcommand{\notinsubfile}[1]{}
\newcommand{\g}[1]{\gls{#1}}
\newcommand{\G}[1]{\Gls{#1}}
\newcommand{\gs}[1]{\glspl{#1}}
\newcommand{\Gs}[1]{\Glspl{#1}}

\DeclareDocumentCommand{\newdualentry}{ O{} O{} m m m m } {
	\newglossaryentry{gls-#3}{name={#5}, text={#5\glsadd{#3}}, description={#6}, #1}
	\makeglossaries
	\newacronym[see={{gls-#3}},#2]{#3}{#4}{#5\glsadd{gls-#3}}
}

\newcommand{\biblio}{\bibliography{References}}

\input{glossary.tex}

\begin{document}

\renewcommand{\onlyinsubfile}[1]{}
\renewcommand{\notinsubfile}[1]{#1}
\def\biblio{}

\begin{preface}
	\lipsum[5]
	\todo{Write something funny here}
\end{preface}

\tableofcontents*

\subfile{abstract}
\subfile{samenvatting}

\mainmatter
\subfile{intro}
\subfile{cheri}
\subfile{glyco}
\subfile{ghscc}
\subfile{objects}
\subfile{closures}
\subfile{conclusion}

\appendix
\subfile{grammar}
\subfile{sisp}

\backmatter
\glsaddall
\setglossarystyle{list}
\printglossaries

\bibliography{References}

\end{document}
