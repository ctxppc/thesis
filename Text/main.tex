% © 2021–2022 Constantino Tsarouhas
\documentclass[master=cws, oneside, english, extralanguage=dutch]{kulemt}	% TODO: twoside for print
\setup{
	masteroption=vs,
	title={A CHERI-RISC-V nanopass compiler for iterating quickly on secure calling conventions},
	author={Constantino Tsarouhas},
	promotor={Prof. dr. Dominique Devriese},
	assistant={Ir. Sander Huyghebaert \and Dr. Steven Keuchel},
	assessor=,	% TODO
	inputenc=utf8,
	font=utopia
}

\usepackage{amsmath}							% Math support
\usepackage{babel}								% Language support
\usepackage[margin=10pt, font=small]{caption}	% Customised captions to distinguish them from main text
\usepackage[autostyle]{csquotes}				% Curly quotes
\usepackage{enumitem}							% Compact list items

\usepackage[dvipsnames]{xcolor}					% Named colours — keep before hyperref
\usepackage{hyperref}							% Hyperlinking and PDF metadata.
\usepackage[capitalise, nameinlink]{cleveref}	% Better references — keep after hyperref
\usepackage[toc]{glossaries}					% Glossary — keep after hyperref!

\usepackage{lipsum}								% Fake lorem ipsum text
\usepackage{listings}							% Source code
\usepackage{subfiles}							% Modular documents
\usepackage{syntax}								% Grammar
\usepackage{todonotes}							% Marks TODOs
\usepackage{xparse}								% Advanced command parsing — used in newdualentry

\hypersetup{
    colorlinks=true,		% false: boxed links; true: coloured links
    linkcolor=Blue,			% colour of internal links
    citecolor=OliveGreen,	% colour of links to bibliography
    filecolor=cyan,			% colour of file links
    urlcolor=magenta		% colour of external links
}

\renewcommand{\syntleft}{\normalfont\color{Plum}\itshape}
\renewcommand{\syntright}{}
\renewcommand{\ulitleft}{\normalfont\bfseries\frenchspacing}
\renewcommand{\ulitright}{}

\lstset{ 
	basicstyle=\footnotesize,			% the size of the fonts that are used for the code
	breakatwhitespace=false,			% sets if automatic breaks should only happen at whitespace
	breaklines=false,					% sets automatic line breaking
	commentstyle=\color{YellowOrange},	% comment style
	keepspaces=true,					% keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
	keywordstyle=\bbseries\color{Fuchsia},
	language=C,							% the language of the code
	morekeywords={*, let, set, source, then, takes, returns, functions, procedures, evaluate, constant, s32, u8, vectorCap, cap, in, to, value, named, location, binary, le, add, sub, relation, true, false, vector, record, element, of, count, capability, scoped, index, getElement, createVector, getField, createRecord, compute, field, createBuffer, setElement, getElement, pushScope, popScope, abstract, setField, registerDatum, code, bytes},
	numbers=left,						% where to put the line numbers; possible values are (none, left, right)
	numbersep=5pt,						% how far the line numbers are from the code
	numberstyle=\tiny\color{Gray},		% the style that is used for the line numbers
	stringstyle=\color{TealBlue},		% string literal style
	tabsize=2,							% sets default tab size to 2 spaces
}

\newcommand{\onlyinsubfile}[1]{#1}
\newcommand{\notinsubfile}[1]{}
\newcommand{\g}[1]{\gls{#1}}
\newcommand{\G}[1]{\Gls{#1}}
\newcommand{\gs}[1]{\glspl{#1}}
\newcommand{\Gs}[1]{\Glspl{#1}}

\DeclareDocumentCommand{\newdualentry}{ O{} O{} m m m m } {
	\newglossaryentry{gls-#3}{name={#5}, text={#5\glsadd{#3}}, description={#6}, #1}
	\makeglossaries
	\newacronym[see={{gls-#3}},#2]{#3}{#4}{#5\glsadd{gls-#3}}
}

\def\biblio{\bibliographystyle{apalike}\bibliography{References}}

\input{glossary.tex}

\begin{document}

\renewcommand{\onlyinsubfile}[1]{}
\renewcommand{\notinsubfile}[1]{#1}
\def\biblio{}

\begin{preface}
	\lipsum[5]
	\todo{Write something funny here}
\end{preface}

\tableofcontents*

\begin{abstract}
	\lipsum[5]
	\todo{Write something serious here}
\end{abstract}

\begin{abstract*}
	\lipsum[5]
	\todo{5 pagina's goud hier a.u.b.}
\end{abstract*}

\mainmatter
\subfile{intro}
\subfile{cheri}
\subfile{glyco}
\subfile{ghscc}
\subfile{objects}
\subfile{conclusion}

\appendix
\subfile{grammar}

\backmatter
\glsaddall
\setglossarystyle{list}
\printglossaries

\bibliographystyle{apalike}
\bibliography{References}

\end{document}
